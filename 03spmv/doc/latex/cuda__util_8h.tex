\hypertarget{cuda__util_8h}{}\section{/home/tau/public\+\_\+html/lecture/parallel\+\_\+distributed/2018/handson/tau/parallel-\/distributed-\/handson/03spmv/include/cuda\+\_\+util.h File Reference}
\label{cuda__util_8h}\index{/home/tau/public\+\_\+html/lecture/parallel\+\_\+distributed/2018/handson/tau/parallel-\/distributed-\/handson/03spmv/include/cuda\+\_\+util.\+h@{/home/tau/public\+\_\+html/lecture/parallel\+\_\+distributed/2018/handson/tau/parallel-\/distributed-\/handson/03spmv/include/cuda\+\_\+util.\+h}}


small utility functions for cuda  


\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}{check\+\_\+api\+\_\+error}(e)~\hyperlink{cuda__util_8h_afe8e81182b6d9bdc912e4477ea7f6221}{check\+\_\+api\+\_\+error\+\_\+}(e, \#e, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+)
\begin{DoxyCompactList}\small\item\em check if a C\+U\+DA A\+PI invocation succeeded and show the error msg if any \end{DoxyCompactList}\item 
\#define \hyperlink{cuda__util_8h_ae8a9e1ffcd7af83a818bc9a6ec7bed78}{check\+\_\+launch\+\_\+error}(exp)~do \{ exp; \hyperlink{cuda__util_8h_a522422f538aba091ae7b9ec113871075}{check\+\_\+launch\+\_\+error\+\_\+}(\#exp, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+); \} while (0)
\begin{DoxyCompactList}\small\item\em check kernel launch error \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{cuda__util_8h_afe8e81182b6d9bdc912e4477ea7f6221}{check\+\_\+api\+\_\+error\+\_\+} (cuda\+Error\+\_\+t e, const char $\ast$msg, const char $\ast$file, int line)
\begin{DoxyCompactList}\small\item\em do not use this function directly. use check\+\_\+api\+\_\+error macro \end{DoxyCompactList}\item 
static void \hyperlink{cuda__util_8h_a522422f538aba091ae7b9ec113871075}{check\+\_\+launch\+\_\+error\+\_\+} (const char $\ast$msg, const char $\ast$file, int line)
\begin{DoxyCompactList}\small\item\em do not use this function directly. use check\+\_\+launch\+\_\+error macro \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a42ba739c08e201d58f7a031d899a0e7f}\label{cuda__util_8h_a42ba739c08e201d58f7a031d899a0e7f}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ uint \hyperlink{cuda__util_8h_a42ba739c08e201d58f7a031d899a0e7f}{get\+\_\+smid} (void)
\begin{DoxyCompactList}\small\item\em get SM executing the caller \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a859de24e23ee0450818ab96ea6a4798a}\label{cuda__util_8h_a859de24e23ee0450818ab96ea6a4798a}} 
static int \hyperlink{cuda__util_8h_a859de24e23ee0450818ab96ea6a4798a}{get\+\_\+freq} ()
\begin{DoxyCompactList}\small\item\em get device frequency \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_afefb7dee05552efd8d1e91a09c90dc79}\label{cuda__util_8h_afefb7dee05552efd8d1e91a09c90dc79}} 
static void $\ast$ \hyperlink{cuda__util_8h_afefb7dee05552efd8d1e91a09c90dc79}{dev\+\_\+malloc} (size\+\_\+t sz)
\begin{DoxyCompactList}\small\item\em wrap cuda\+Malloc. cuda\+Malloc + error check + more ordinary malloc-\/like interface (return pointer) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_ade14b7c582717d436e547ed0fcf8e4fe}\label{cuda__util_8h_ade14b7c582717d436e547ed0fcf8e4fe}} 
static void \hyperlink{cuda__util_8h_ade14b7c582717d436e547ed0fcf8e4fe}{dev\+\_\+free} (void $\ast$a)
\begin{DoxyCompactList}\small\item\em wrap cuda\+Free \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a0737678a7fc54cb0347e3c4178ad5dfa}\label{cuda__util_8h_a0737678a7fc54cb0347e3c4178ad5dfa}} 
void \hyperlink{cuda__util_8h_a0737678a7fc54cb0347e3c4178ad5dfa}{to\+\_\+host} (void $\ast$dst, void $\ast$src, size\+\_\+t sz)
\begin{DoxyCompactList}\small\item\em wrap cuda\+Memcpy to copy from device to host (and check an error if any) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a7b851642eafb77c5d1945bcf81916d7c}\label{cuda__util_8h_a7b851642eafb77c5d1945bcf81916d7c}} 
static void \hyperlink{cuda__util_8h_a7b851642eafb77c5d1945bcf81916d7c}{to\+\_\+dev} (void $\ast$dst, void $\ast$src, size\+\_\+t sz)
\begin{DoxyCompactList}\small\item\em wrap cuda\+Memcpy to copy from host to device (and check an error if any) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a30655f0f077528b999634c85513af4b0}\label{cuda__util_8h_a30655f0f077528b999634c85513af4b0}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_a30655f0f077528b999634c85513af4b0}{get\+\_\+thread\+\_\+id\+\_\+x} ()
\begin{DoxyCompactList}\small\item\em thread ID along x-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a6ea184310bf6fc2e1313127215aab5b0}\label{cuda__util_8h_a6ea184310bf6fc2e1313127215aab5b0}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_a6ea184310bf6fc2e1313127215aab5b0}{get\+\_\+thread\+\_\+id\+\_\+y} ()
\begin{DoxyCompactList}\small\item\em thread ID along y-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_afff8c5c6d0e85b4a264786a4170ad777}\label{cuda__util_8h_afff8c5c6d0e85b4a264786a4170ad777}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_afff8c5c6d0e85b4a264786a4170ad777}{get\+\_\+thread\+\_\+id\+\_\+z} ()
\begin{DoxyCompactList}\small\item\em thread ID along z-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_ae13980c33ac8f950ed35d613415034c0}\label{cuda__util_8h_ae13980c33ac8f950ed35d613415034c0}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_ae13980c33ac8f950ed35d613415034c0}{get\+\_\+nthreads\+\_\+x} ()
\begin{DoxyCompactList}\small\item\em number of threads along x-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a79fd9ff68db3a81b8b0feb446e4e9b99}\label{cuda__util_8h_a79fd9ff68db3a81b8b0feb446e4e9b99}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_a79fd9ff68db3a81b8b0feb446e4e9b99}{get\+\_\+nthreads\+\_\+y} ()
\begin{DoxyCompactList}\small\item\em number of threads along y-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a59cd23ec9bc1ab07e3eaac1ad3e109b4}\label{cuda__util_8h_a59cd23ec9bc1ab07e3eaac1ad3e109b4}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_a59cd23ec9bc1ab07e3eaac1ad3e109b4}{get\+\_\+nthreads\+\_\+z} ()
\begin{DoxyCompactList}\small\item\em number of threads along z-\/dimension \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_ace44c6e6794929ce9e48e1122c7a3a12}\label{cuda__util_8h_ace44c6e6794929ce9e48e1122c7a3a12}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_ace44c6e6794929ce9e48e1122c7a3a12}{get\+\_\+thread\+\_\+id} ()
\begin{DoxyCompactList}\small\item\em global (x,y,z combined into an integer) thread ID \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cuda__util_8h_a74d008c0d996e10f203bdd1fdee76511}\label{cuda__util_8h_a74d008c0d996e10f203bdd1fdee76511}} 
\+\_\+\+\_\+device\+\_\+\+\_\+ int \hyperlink{cuda__util_8h_a74d008c0d996e10f203bdd1fdee76511}{get\+\_\+nthreads} ()
\begin{DoxyCompactList}\small\item\em total number of threads \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
small utility functions for cuda 

\begin{DoxyAuthor}{Author}
Kenjiro Taura 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Oct. 14, 2018 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}\label{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}} 
\index{cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}!check\+\_\+api\+\_\+error@{check\+\_\+api\+\_\+error}}
\index{check\+\_\+api\+\_\+error@{check\+\_\+api\+\_\+error}!cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+api\+\_\+error}{check\_api\_error}}
{\footnotesize\ttfamily \#define check\+\_\+api\+\_\+error(\begin{DoxyParamCaption}\item[{}]{e }\end{DoxyParamCaption})~\hyperlink{cuda__util_8h_afe8e81182b6d9bdc912e4477ea7f6221}{check\+\_\+api\+\_\+error\+\_\+}(e, \#e, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+)}



check if a C\+U\+DA A\+PI invocation succeeded and show the error msg if any 

usage\+: \hyperlink{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}{check\+\_\+api\+\_\+error(cuda\+\_\+api\+\_\+call())}. for example, \hyperlink{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}{check\+\_\+api\+\_\+error(cuda\+Malloc(\&p, size))}; \mbox{\Hypertarget{cuda__util_8h_ae8a9e1ffcd7af83a818bc9a6ec7bed78}\label{cuda__util_8h_ae8a9e1ffcd7af83a818bc9a6ec7bed78}} 
\index{cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}!check\+\_\+launch\+\_\+error@{check\+\_\+launch\+\_\+error}}
\index{check\+\_\+launch\+\_\+error@{check\+\_\+launch\+\_\+error}!cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+launch\+\_\+error}{check\_launch\_error}}
{\footnotesize\ttfamily \#define check\+\_\+launch\+\_\+error(\begin{DoxyParamCaption}\item[{}]{exp }\end{DoxyParamCaption})~do \{ exp; \hyperlink{cuda__util_8h_a522422f538aba091ae7b9ec113871075}{check\+\_\+launch\+\_\+error\+\_\+}(\#exp, \+\_\+\+\_\+\+F\+I\+L\+E\+\_\+\+\_\+, \+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+); \} while (0)}



check kernel launch error 

usage\+: check\+\_\+launch\+\_\+error((kernel-\/launch-\/expression)). for example, check\+\_\+launch\+\_\+error((your\+\_\+gpu\+\_\+kernel$<$$<$$<$n\+\_\+blocks,block\+\_\+sz$>$$>$$>$(a,b,c))). note that you need to put parens around the expression. 

\subsection{Function Documentation}
\mbox{\Hypertarget{cuda__util_8h_afe8e81182b6d9bdc912e4477ea7f6221}\label{cuda__util_8h_afe8e81182b6d9bdc912e4477ea7f6221}} 
\index{cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}!check\+\_\+api\+\_\+error\+\_\+@{check\+\_\+api\+\_\+error\+\_\+}}
\index{check\+\_\+api\+\_\+error\+\_\+@{check\+\_\+api\+\_\+error\+\_\+}!cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+api\+\_\+error\+\_\+()}{check\_api\_error\_()}}
{\footnotesize\ttfamily static void check\+\_\+api\+\_\+error\+\_\+ (\begin{DoxyParamCaption}\item[{cuda\+Error\+\_\+t}]{e,  }\item[{const char $\ast$}]{msg,  }\item[{const char $\ast$}]{file,  }\item[{int}]{line }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



do not use this function directly. use check\+\_\+api\+\_\+error macro 

\begin{DoxySeeAlso}{See also}
\hyperlink{cuda__util_8h_ae08da20e750e9eabdf37c5cdf87a6e73}{check\+\_\+api\+\_\+error} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{cuda__util_8h_a522422f538aba091ae7b9ec113871075}\label{cuda__util_8h_a522422f538aba091ae7b9ec113871075}} 
\index{cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}!check\+\_\+launch\+\_\+error\+\_\+@{check\+\_\+launch\+\_\+error\+\_\+}}
\index{check\+\_\+launch\+\_\+error\+\_\+@{check\+\_\+launch\+\_\+error\+\_\+}!cuda\+\_\+util.\+h@{cuda\+\_\+util.\+h}}
\subsubsection{\texorpdfstring{check\+\_\+launch\+\_\+error\+\_\+()}{check\_launch\_error\_()}}
{\footnotesize\ttfamily static void check\+\_\+launch\+\_\+error\+\_\+ (\begin{DoxyParamCaption}\item[{const char $\ast$}]{msg,  }\item[{const char $\ast$}]{file,  }\item[{int}]{line }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



do not use this function directly. use check\+\_\+launch\+\_\+error macro 

\begin{DoxySeeAlso}{See also}
\hyperlink{cuda__util_8h_ae8a9e1ffcd7af83a818bc9a6ec7bed78}{check\+\_\+launch\+\_\+error} 
\end{DoxySeeAlso}
